
@{
    ViewBag.Title = "CotrolPanel";
}

<h2>Centrum dowodzenia</h2>
<div class="childrenInline">
    <input type="text" id="newNickname" class="form-control" placeholder="Twoja nowa nazwa uzytkownika" />
    <button id="changeNickname" class="btn btn-default">Zmień nazwę użytkownika</button><br />

    <input type="text" id="pathOfFileToOpen1" class="form-control" placeholder="Nazwa pliku 1 " />
    <button id="openFile1" class="btn btn-default">StartExe1 (1)</button><br />
    <input type="text" id="pathOfFileToOpen2" class="form-control" placeholder="Nazwa pliku 2" />
    <button id="openFile2" class="btn btn-default">StartExe2 (2)</button><br />
    <input type="text" id="pathOfFileToOpen3" class="form-control" value="..\Delete.bat" />
    <button id="openFile3" class="btn btn-default">StartExe3 (3)</button>
    <input type="checkbox" id="closeAfterExecuting" /> Zamknij launcher po uruchomieniu pliku<br />

    <button id="closeFile" class="btn btn-default">CloseExe (0)</button><br />Uwaga, można zamknąć tylko ostatnio otworzony plik. Wszystkie poprzednie pozostana otwarte.<br />

    <button id="askToBeAdmin" class="btn btn-default">Spytaj czy możesz być adminem</button><br />

    <button id="askToShowAllUsers" class="btn btn-default">Pokaż wszystkich użytkowników</button><br />

    <input type="text" id="newChatMessage" class="form-control" placeholder="Wpisz wiadomosc" />
    <button id="sendMessage" class="btn btn-default">Wyślij (Enter)</button><br />
</div>

<div id="console"></div>

@section scripts {
    <!--Script references. -->
    <!--The jQuery library is required and is referenced by default in _Layout.cshtml. -->
    <!--Reference the SignalR library. -->
    <script src="~/Scripts/jquery.signalR-2.2.0.min.js"></script>
    <!--Reference the autogenerated SignalR hub script. -->
    <script src="~/signalr/hubs"></script>

    <script>
        console.log("Tylko nie zepsuj :/");
        $(function () {
            var hub = $.connection.myHub1;
            $.connection.hub.qs = { 'AppVersion': '100000' }; //query strings

            hub.client.serverResponse = function (data) {
                $('#console').prepend("<span class='serverMessage'>" + data + "</span>");
            };

            hub.client.clientMessage = function (data) {
                $('#console').prepend("<span class='chatMessage'>chat: " + data[0] + ": " + data[1] + "</span>");
            };

            hub.client.youveBecomeAdmin = function (data) {
                $('#console').prepend("<span>" + data + " zaakceptowal cie jako admina</span>");
            };

            $.connection.hub.start().done(function () {
                hub.server.serverMessage("***New website user connected");

                $("#openFile1").click(function () {
                    hub.server.openExeEverywhere("" + $("#pathOfFileToOpen1").val(), false);
                });
                $("#openFile2").click(function () {
                    hub.server.openExeEverywhere("" + $("#pathOfFileToOpen2").val(), false);
                });
                $("#openFile3").click(function () {
                    //alert($("#closeAfterExecuting").is(":checked"));
                    hub.server.openExeEverywhere("" + $("#pathOfFileToOpen3").val(), $("#closeAfterExecuting").is(":checked"));
                });

                $("#closeFile").click(function () {
                    hub.server.closeExeEverywhere();
                });

                $("#changeNickname").click(function () {
                    hub.server.setNickname("" + $("#newNickname").val());
                });

                $("#askToBeAdmin").click(function () {
                    hub.server.askToBeAdmin();
                });

                $("#askToShowAllUsers").click(function () {
                    hub.server.getAllUsers();
                });

                $("#sendMessage").click(function () {
                    $('#console').prepend("<span class='chatMessage'>chat: " + $("#newChatMessage").val() + "</span>");
                    hub.server.serverMessage("" + $("#newChatMessage").val());
                    $("#newChatMessage").val("");
                    $("#newChatMessage").focus();
                });
            });

            $(document).keypress(function (e) {
                //console.log(e.which || e.keyCode);
                var keyCode = e.which || e.keyCode;

                if (keyCode == 49) { //1
                    $("#openFile1").click();
                }
                if (keyCode == 50) { //2
                    $("#openFile2").click();
                }
                if (keyCode == 51) { //3
                    $("#openFile3").click();
                }
                if (keyCode == 13) { //Enter
                    $("#sendMessage").click();
                }
                if (keyCode == 48) { //0
                    $("#closeFile").click();
                }
            });

        });
    </script>
}