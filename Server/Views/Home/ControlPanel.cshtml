
@{
    ViewBag.Title = "CotrolPanel";
}

<h2>Centrum dowodzenia</h2>
<div class="childrenInline">
    <input type="text" id="newNickname" class="form-control" placeholder="Twoja nowa nazwa uzytkownika" />
    <button id="changeNickname" class="btn btn-default">Zmień nazwę</button><br />

    <input type="text" id="pathOfFileToOpen" class="form-control" placeholder="Nazwa pliku" />
    <button id="openFile" class="btn btn-default">StartExe</button><br />

    <button id="askToBeAdmin" class="btn btn-default">Spytaj czy możesz być adminem</button><br />

    <input type="text" id="newChatMessage" class="form-control" placeholder="Wpisz wiadomosc" />
    <button id="sendMessage" class="btn btn-default">Wyślij</button><br />
</div>

<div id="console"></div>

@section scripts {
    <!--Script references. -->
    <!--The jQuery library is required and is referenced by default in _Layout.cshtml. -->
    <!--Reference the SignalR library. -->
    <script src="~/Scripts/jquery.signalR-2.2.0.min.js"></script>
    <!--Reference the autogenerated SignalR hub script. -->
    <script src="~/signalr/hubs"></script>

    <script>
        $(function () {
            var hub = $.connection.myHub1;

            hub.client.serverResponse = function (data) {
                $('#console').prepend("<span class='serverMessage'>" + data + "</span>");
            };

            hub.client.clientMessage = function (data) {
                $('#console').prepend("<span class='chatMessage'>chat: " + data[0] + ": " + data[1] + "</span>");
            };

            hub.client.youveBecomeAdmin = function (data) {
                $('#console').prepend("<span>" + data + " zaakceptowal cie jako admina</span>");
            };

            $.connection.hub.start().done(function () {
                hub.server.serverMessage("***New website user connected");

                $("#openFile").click(function () {
                    hub.server.openExeEverywhere("" + $("#pathOfFileToOpen").val());
                });

                $("#changeNickname").click(function () {
                    hub.server.setNickname("" + $("#newNickname").val());
                });

                $("#askToBeAdmin").click(function () {
                    hub.server.askToBeAdmin();
                });

                $("#sendMessage").click(function () {
                    hub.server.serverMessage("" + $("#newChatMessage").val());
                });
            });

            
        });
    </script>
}